<!DOCTYPE html>
<html lang="en">
 <head>
    <title>Eric Stassen</title>
   <meta charset="UTF-8" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <link rel="stylesheet" href="hurlinganalytics.css" />
   <meta name="description" content="Eric Stassen's Hurling Analytics">
   <link rel="icon" href="img/e-s-high-resolution-color-logo.png">
 </head>
 <body>
    <nav class="navbar">
        <!-- LOGO -->
        <div class="logo">
           <a href="index.html">
               <img class="logo" src="img/eric-stassen-high-resolution-logo-color-on-transparent-background-name.png">
           </a>
       </div>
        <!-- NAVIGATION MENU -->
        <ul class="nav-links">
          <!-- USING CHECKBOX HACK -->
          <input type="checkbox" id="checkbox_toggle" />
          <label for="checkbox_toggle" class="hamburger">&#9776;</label>
          <!-- NAVIGATION MENUS -->
          <div class="menu">
            <li><a href="about.html">About</a></li>
            <li><a href="projects.html">Projects</a></li>
            <!-- <li class="projects">
              <input type="checkbox" id="checkbox_toggle_projects" />
               <label for="checkbox_toggle_projects" class="checkbox_projects">Projects</label>
              <ul class="dropdown">
                <li><a href="ericstassen.html">EricStassen.com</a></li>
              </ul>
            </li> -->
            <li><a href="contact.html">Contact</a></li>
            <li><a href="signin.html">Sign In</a></li>
          </div>
        </ul>
      </nav>

      <section class="first_section">
    
        <div class="non_photo">
          <h1>
            Hurling - Analytics
        </h1>
          <div class="text">
          <h2>
            Foreword
        </h2>
          <p>
            Hurling is an Irish team sport that involves many unique skills and strategies. 
            If you're unfamiliar with the sport, more information can be found <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Hurling">here</a>.  
            I started playing Hurling at the University of Connecticut in 2016 have played for the <a target="_blank" rel="noopener noreferrer"  href="https://www.hartfordgaa.com/">Hartford GAA</a>  since 2020.
            I always wanted to figure out a way to play more efficiently, so I decided to investigate from a data perspective.
          </p>
          <p>
            This is part two of a two-part analysis.
            Part <a href="hurlingdata.html">one</a> covers data collection and basic calculations.
            Part two covers analytics and how we approach improving our team's efficiency.
          </p>
        <h2>
            Abstract
        </h2>
        <p>
          Analytics for sports has been gaining popularity, but I have seen little use in Hurling.
          The following project is an approach to use analytics to help players better understand the game.
          For this post, I am purposefully not sharing good models, just explaining why and how to implement them to improve our team.
          The dataset from part one of this project is used as the input data and is supplemented with information about passes from the same video.
          Several additional data fields are derived with Pandas and a logistic regression model is built to predict whether future passes will be completed.
          Then the model is interpreted and applied to our matches to teach our players the best strategies.
          My team plays in a competitive league so the modeling process shared here will not be complete.
          The code and data shared is merely representative and is not an indication of strengths, weaknesses, or strategies of the team.
          It should also be noted that this analysis is not intended to replace coaches or be the sole indicator of what to do.
          This work is only intended to augment coaches' and players' decision-making, planning, and understandings.
        </p>
        <h2>
            Introduction
        </h2>
          <h3>
            Background
          </h3>
          <p>
            Please see part <a href="hurlingdata.html">one</a> for background.
            This work will pick up where the previous work left off, which was with a dataset of player positions during a match.
          </p>
          <h3>
            Intentions
          </h3>
          <p>
            Once data is available, there are countless uses.
            However, there is a huge gap between having data and making it useful.
            First, you must have a problem to solve.
            Then, you need to solve it.
            Lastly, you need to be able to transfer the solution from a computer to players' minds while they're on the field.
            The work below provides a framework to complete those steps.
            We are a competitive team though, so I am purposefully not sharing a real solution.
          </p>
          <h3>
            Purpose
          </h3>
          <p>
            The example problem I am trying to solve is predicting whether a pass will be completed or not.
            This is useful to us because we want to avoid turnovers during games.
            Every turnover is a lost opportunity for our team to score and a new opportunity for the opposing team to score.
            Passes are something that we have control over, so we can make conscious change if necessary.
          </p>
        <h2>
            Implementation
        </h2>
        <h3>
          Raw Data
        </h3>
        <p>
          To predict pass completions, the dataset from part one needs pass information.
          Fortunately, the data is easy to manually collect.
          I simply watched the video and recorded the actions, players, and frame numbers.
          However, we need a definition of a "completed pass".
          I decided to define it as the ball reaching the intended target before being touched by the opposing team.
          The intended recipient does not need to gain possession for the pass to be considered completed.
          The purpose of this study is to make good passing decisions, so it is a good decision to pass the ball if it reaches the person you want it to reach.
          If the player receiving the pass doesn't collect the ball, that's a different skill to evaluate.
          To see the passes and my evaluation, check out the video below and the <a target="_blank" rel="noopener noreferrer" href="https://github.com/EJstass/hurling-analytics/blob/main/yolov7_sort_mot_plot_passprob.ipynb">code</a>.
        </p>
        <div id="youtube_iframe">
          <iframe src="https://www.youtube.com/embed/XkAYrqeZLiw?si=TT7-Mt5GlMuYN-2-" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
      </div>
        <h3>
          Data Evaluation
        </h3>

        <p>
          The next step is to evaluate the data.
          The purpose of this work is a classification model, so let's check out the distribution of the target variable (each of the pass results in the video).
          True means the pass was completed.
          False means the pass was intercepted.
        </p>
        <table>  <thead>  <tr>      <th></th>     <th>Outcome</th>    </tr>  </thead>  <tbody>    <tr>      <th>True</th>      <td>10</td>    </tr>    <tr>      <th>False</th>      <td>3</td>    </tr>  </tbody></table>
        <p>
          Unfortunately, the sample size is miniscule and the distribution is severely unbalanced.
          Any models built will be poor, but let's continue anyways for the purpose of showing what's possible with more data.
        </p>
        <h3>
          Predictors
        </h3>
        <p>
          To predict pass completion, we need variables that can be judged by a player on the field in real-time.
          The general variables we tend to look for naturally are: how far away the receiving player is, how many defenders are between the passer and the receiver (which I call the number of pass interceptors), where the closest defender is relative to the receiver (distance and angle relative to the ball), the speed of the receiver, and the speed of the defender.
          Truthfully, that's a lot of variables to mentally process during the one second we take to decide whether to pass, but an analysis of these variables could tell us what to focus on.
        </p>
        <p>
          Fortunately, all of these variables are somewhat possible to judge in real-time and they're all easy to derive from the dataset we have available.
          Distance and speed were already derived in part one; they just need to be extrapolated to each player relative to each other.
          The new calculations are angle and number of pass interceptors.
        </p>
        <p>
          Angle can be calculated using the "math" library in Python which uses the coordinates of 3 points: ball, receiver, defender.
        </p>
        <p>
          In contrast, the number of pass interceptors is slightly more complicated.
          I decided to approach it as any defender who was moving fast enough to cross the projected path of the ball.
          The projected path of the ball is the line between the ball's current coordinates and the coordinates of the receiver.
          A defender can intercept the pass if they move into the path of the ball.
          The distance the defender has to travel is an orthogonal line to the path of the ball, which is calculable.
          I then assumed the ball moves at a max speed of around 40MPH and the average defender can sprint at about half that speed.
          Therefore, to determine the number of pass interceptors, I counted the number of defenders whose orthogonal line was at most half of the remaining distance of the pass.
        </p>
        <p>
          An example record of the variables and their values is below:
        </p>
        <table>  <thead>    <tr>      <th></th>      <th>Example Pass</th>    </tr>  </thead>  <tbody>    <tr>      <th>frame</th>      <td>132</td>    </tr>    <tr>      <th>passer</th>      <td>Eric</td>    </tr>    <tr>      <th>receiver</th>      <td>player5</td>    </tr>    <tr>      <th>Outcome</th>      <td>True</td>    </tr>    <tr>      <th>Name</th>      <td>player5</td>    </tr>    <tr>      <th>pass_distance</th>      <td>9.692406</td>    </tr>    <tr>      <th>nbr_of_interceptors</th>      <td>0.0</td>    </tr>    <tr>      <th>nearest_defender_dist</th>      <td>15.176655</td>    </tr>    <tr>      <th>nearest_defender_angle</th>      <td>42.959883</td>    </tr>    <tr>      <th>nearest_defender_speed</th>      <td>9.242666</td>    </tr>    <tr>      <th>nearest_defender_speed_rel</th>      <td>4.370869</td>    </tr>    <tr>      <th>receiver_speed</th>      <td>2.114606</td>    </tr>  </tbody></table>
        <p>
          At this point, it would be a good idea to evaluate the quality of these predictors relative to the target field.
          However, with the small sample size, let's jump straight into modeling.
          As discussed previously, a good model is not the purpose of this post.
        </p>
        <h3>
          Modeling #1
        </h3>
        
        <p>
          Model building is an iterative process, so this is my first very basic attempt.
          Before building the model, the dataset of passes is split into training and testing.
          Then, I used the LogisticRegression class from sklearn to model the training data.
          To evaluate the quality of the model, let's check its precision-recall for the test data.
          Unfortunately, there are only two records in the test dataset and the model predicts both incorrectly.
        </p>
        <table>  <thead>    <tr>      <th></th>      <th>False</th>      <th>True</th>      <th>accuracy</th>      <th>macro avg</th>      <th>weighted avg</th>    </tr>  </thead>  <tbody>    <tr>      <th>precision</th>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>recall</th>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>f1-score</th>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>support</th>      <td>1.0</td>      <td>1.0</td>      <td>0.0</td>      <td>2.0</td>      <td>2.0</td>    </tr>  </tbody></table>
        <h3>
          Modeling #2
        </h3>
        <p>
          The first model had severe limitations, so I decided to take a slightly different approach.
          My primary goal was to increase the number of records for the sake of example.
          To gain more records, I recorded success/failure for every frame of each pass (from the moment the passer hits the ball until the receiver or defenders touches it).
          That way each pass produced dozens of records and the resulting dataset contained hundreds.
          A quick look at the target field distribution:
        </p>
        <table>  <thead>    <tr>      <th></th>      <th>Outcome</th>    </tr>  </thead>  <tbody>    <tr>      <th>True</th>      <td>500</td>    </tr>    <tr>      <th>False</th>      <td>213</td>    </tr>  </tbody></table>
        <p>
          At this point a new model can be trained.
          This time, I chose to use the Logit class from the statsmodels api.
          The results of the model are below.
        </p>
        <table class="simpletable"><caption>Logit Regression Results</caption><tr>  <th>Dep. Variable:</th>        <td>Outcome</td>     <th>  No. Observations:  </th>  <td>   713</td>  </tr><tr>  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>   706</td>  </tr><tr>  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     6</td>  </tr><tr>  <th>Date:</th>            <td>Sat, 30 Sep 2023</td> <th>  Pseudo R-squ.:     </th>  <td>0.2350</td>  </tr><tr>  <th>Time:</th>                <td>20:57:02</td>     <th>  Log-Likelihood:    </th> <td> -332.61</td> </tr><tr>  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -434.78</td> </tr><tr>  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>2.267e-41</td></tr></table><table class="simpletable"><tr>               <td></td>                 <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  </tr><tr>  <th>pass_distance</th>              <td>    0.0382</td> <td>    0.006</td> <td>    6.352</td> <td> 0.000</td> <td>    0.026</td> <td>    0.050</td></tr><tr>  <th>nbr_of_interceptors</th>        <td>   -0.7854</td> <td>    0.130</td> <td>   -6.028</td> <td> 0.000</td> <td>   -1.041</td> <td>   -0.530</td></tr><tr>  <th>nearest_defender_dist</th>      <td>    0.0125</td> <td>    0.009</td> <td>    1.342</td> <td> 0.180</td> <td>   -0.006</td> <td>    0.031</td></tr><tr>  <th>nearest_defender_angle</th>     <td>    0.0017</td> <td>    0.001</td> <td>    1.922</td> <td> 0.055</td> <td>-3.36e-05</td> <td>    0.003</td></tr><tr>  <th>nearest_defender_speed</th>     <td>   -0.4726</td> <td>    0.062</td> <td>   -7.577</td> <td> 0.000</td> <td>   -0.595</td> <td>   -0.350</td></tr><tr>  <th>nearest_defender_speed_rel</th> <td>    1.2923</td> <td>    0.190</td> <td>    6.815</td> <td> 0.000</td> <td>    0.921</td> <td>    1.664</td></tr><tr>  <th>receiver_speed</th>             <td>    0.2600</td> <td>    0.049</td> <td>    5.352</td> <td> 0.000</td> <td>    0.165</td> <td>    0.355</td></tr></table> 
        <p>
          While still not a good model, this provides much more to work with.
          Let's apply it to the field!
        </p>
        <h3>
          Taking Action
        </h3>
        <p>
          Many people would struggle to find any model useful.
          All of the work completed up to this point is a waste if it can't be consumed effectively by the players on our team.
          Therefore, it needs to be presented well.
          There are two approaches I would take to communicating these results.
        </p>
        <p>
          First, the model summary statistics are very valuable to our decision-making.
          The summary shows us which predictors are most important.
          Based on P-value, we can see that the nearest defender's distance and angle from the receiver are not very important.
          In contrast pass distance, number of interceptors, nearest defender speed, nearest defender relative speed, and receiver speed are most important.
          If this was a reliable model (which it's not), we could instruct our players to only focus on what is important.
          Similarly, we should look at the coefficients of the predictors to see how to evaluate.
          For example, the pass_distance variable has a positive coefficient, which indicates that longer passes have a higher likelihood of completion.
          The number of interceptors variable has a negative coefficient, which indicates that fewer interceptors is better.
          Information like this can be translated into very simple instructions: hit the ball far where there is the fewest number of defenders in the way.
        </p>
        <p>
          Second, we can present pass completion probabilities visually in match video.
          To display pass probabilities, we only need to derive the predictors for each player on the field per frame, then run the model predictions.
          Once predictions have been established, they can be plotted to video.
          The video below shows the pass completion probabilities for every pass option.
          It clearly shows whether the pass decision was a good idea or a bad idea relative to all the other options.
        </p>
           <div id="youtube_iframe">
            <iframe src="https://www.youtube.com/embed/W4mNetyDUSI?si=VXRX5CGj46jv-4Co" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>
  
            </iframe>
            </div>
        <h2>
            Conclusion & Next Steps
        </h2>
          <p>
           This analytics approach provides endless opportunities for team improvements.
           With enough data, models can be built to examine any number of situations within a match.
           We could even build models to simulate thousands of matches to find the best strategy.
           Most importantly, this communication of the model results is an effective way for the team to learn.
           Coaches can spend a lifetime learning the game and figuring out which strategies work best.
           This analytical method would empower a coach and team to learn in a fraction of the time.
          </p>
        <h2>
        
        <h2>
            My Links
        </h2>
          <p>
            GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/EJstass/hurling-analytics">Hurling</a>    
          </p>

      </div>
      </div>
      <div class="photo">
    
        </div>
        <div class="location">
          <a target="_blank" rel="noopener noreferrer"  href="https://www.hartfordgaa.com/">Where am I?</a>
        </div>
        </section>


 </body>
</html>